

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>2.2.5. Rydberg Pair Potentials Under External Fields &mdash; pairinteraction 0.9.7-alpha documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.2.6. Dispersion Coefficients Near Surfaces" href="vdw_near_surface.html" />
    <link rel="prev" title="2.2.4. Blockade Interaction in a Magnetic Field" href="comparison_to_saffman_fig13.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pairinteraction
          

          
            
            <img src="../_static/logo48x48.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.9.7-alpha
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          

            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">2. Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#graphical-user-interface">2.1. Graphical User Interface</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#python-api">2.2. Python API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">2.2.1. Introduction to the pairinteraction Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="matrix_elements.html">2.2.2. Calculation of Matrix Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="wavefunctions.html">2.2.3. Radial Wavefunctions and Quantum Defects</a></li>
<li class="toctree-l3"><a class="reference internal" href="comparison_to_saffman_fig13.html">2.2.4. Blockade Interaction in a Magnetic Field</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.2.5. Rydberg Pair Potentials Under External Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="vdw_near_surface.html">2.2.6. Dispersion Coefficients Near Surfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="pair_potential_near_surface.html">2.2.7. Rydberg Pair Potentials Near Surfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="atom_ion_interaction.html">2.2.8. Rydberg Atom Ion Interaction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Indices and Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
</ul>

            
          
<style>
a.gitbutton {
  display: block;
  font-size: 18px;
  line-height: 1.5;
  color: #fff;
  padding-top: 10px;
  padding-left: 85px;
  padding-right: 0px;
  margin: 22px;
  width: 240px;
  height: 60px;
  background: transparent url("../_static/buttons/github.svg") 0 0 no-repeat;
}
a.gitbutton small {
  display: block;
  font-size: 11px;
}
button.toctree-expand {
  display: none;
}
</style>
<a href="https://github.com/pairinteraction/pairinteraction/releases" class="gitbutton">Download<small>pairinteraction on GitHub</small></a>

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pairinteraction</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html"><span class="section-number">2. </span>Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">2.2.5. </span>Rydberg Pair Potentials Under External Fields</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples_python/pair_potential_efield_sensitivity.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }
</style>

<div class="admonition note">
  This page was generated from the Jupyter notebook
  <a class="reference external" href="pair_potential_efield_sensitivity.ipynb">pair_potential_efield_sensitivity.ipynb</a>.
</div><div class="section" id="Rydberg-Pair-Potentials-Under-External-Fields">
<h1><span class="section-number">2.2.5. </span>Rydberg Pair Potentials Under External Fields<a class="headerlink" href="#Rydberg-Pair-Potentials-Under-External-Fields" title="Permalink to this headline">¶</a></h1>
<p>Experimental parameters have to be chosen carefully to maintain the Rydberg blockade as discussed in S. de Léséleuc, S. Weber, V. Lienhard, D. Barredo, H.P. Büchler, T. Lahaye, A. Browaeys, “Accurate mapping of multilevel Rydberg atoms on interacting spin-1/2 particles for the quantum simulation of Ising models”, <a class="reference external" href="http://doi.org/10.1103/PhysRevLett.120.113602">Phys. Rev. Lett. 120, 113602 (2018)</a>. Here we reproduce the result shown in Fig. 2c,d that the Rydberg blockade of <span class="math notranslate nohighlight">\(nD\)</span>-states
can be broken by suprisingly small electric fields, i.e. by fields which cause only a tiny single-atom Stark shift. The parameter dependence of the electric field sensitivity can be studied by rerunning the Jupyter notebook for different interaction angles, external magnetic fields, or principal quantum numbers. The <a class="reference external" href="https://github.com/pairinteraction/pairinteraction/blob/master/doc/sphinx/examples_python/pair_potential_efield_sensitivity.ipynb">Jupyter notebook</a> and the final <a class="reference external" href="https://github.com/pairinteraction/pairinteraction/blob/master/doc/sphinx/examples_python/pair_potential_efield_sensitivity.py">Python
script</a> are available on GitHub.</p>
<p>As described in the <a class="reference internal" href="introduction.html"><span class="doc">introduction</span></a>, we start our code with some preparations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Arrays</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="c1"># Plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cycler</span> <span class="kn">import</span> <span class="n">cycler</span>

<span class="c1"># Operating system interfaces</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># pairinteraction :-)</span>
<span class="kn">from</span> <span class="nn">pairinteraction</span> <span class="kn">import</span> <span class="n">pireal</span> <span class="k">as</span> <span class="n">pi</span>

<span class="c1"># Create cache for matrix elements</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">MatrixElementCache</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We begin by defining some constants of our calculation: the spatial separations of the Rydberg atoms for which we want to evaluate the pair potential, a zero and non-zero electric field, the external magnetic field, and a generic interaction angle. The units of the respective quantities are given as comments.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># µm</span>
<span class="n">efields</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.020</span><span class="p">]</span>  <span class="c1"># V/cm</span>
<span class="n">bfield</span> <span class="o">=</span> <span class="mf">6.9</span>  <span class="c1"># Gauss</span>
<span class="n">angle</span> <span class="o">=</span> <span class="mi">78</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>  <span class="c1"># rad</span>
</pre></div>
</div>
</div>
<p>Now, we use pairinteraction’s <code class="docutils literal notranslate"><span class="pre">StateOne</span></code> class to define the single-atom state <span class="math notranslate nohighlight">\(\left|61d_{3/2},m_j=3/2\right\rangle\)</span> of a Rubidium atom.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">state_one</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateOne</span><span class="p">(</span><span class="s2">&quot;Rb&quot;</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, we define how to set up the single atom system. We do this using a function, so we can easily create systems with the electric field as a parameter. Inside the function, we create a new system by passing the <code class="docutils literal notranslate"><span class="pre">state_one</span></code> and the cache directory we created to <code class="docutils literal notranslate"><span class="pre">SystemOne</span></code>.</p>
<p>To limit the size of the basis, we have to choose cutoffs on states which couple to <code class="docutils literal notranslate"><span class="pre">state_one</span></code>. This is done by means of the <code class="docutils literal notranslate"><span class="pre">restrict...</span></code> functions in <code class="docutils literal notranslate"><span class="pre">SystemOne</span></code>.</p>
<p>We set the external fields to point in <span class="math notranslate nohighlight">\(z\)</span>-direction.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">setup_system_one</span><span class="p">(</span><span class="n">efield</span><span class="p">):</span>
    <span class="n">system_one</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">SystemOne</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(),</span> <span class="n">cache</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictEnergy</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">getEnergy</span><span class="p">()</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">getEnergy</span><span class="p">()</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictN</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">getN</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">getN</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictL</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">getL</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">getL</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">setBfield</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bfield</span><span class="p">])</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">setEfield</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">efield</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">system_one</span>
</pre></div>
</div>
</div>
<p>To investigate the <span class="math notranslate nohighlight">\(\left|61d_{3/2},m_j=3/2;61d_{3/2},m_j=3/2\right\rangle\)</span> pair state, we combine the same single-atom state twice into a pair state using <code class="docutils literal notranslate"><span class="pre">StateTwo</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">state_two</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateTwo</span><span class="p">(</span><span class="n">state_one</span><span class="p">,</span> <span class="n">state_one</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Akin to the single atom system, we now define how to create a two atom system. We want to parametrize this in terms of the single atom system and the spatial separation.</p>
<p>We compose a <code class="docutils literal notranslate"><span class="pre">SystemTwo</span></code> from two identical <code class="docutils literal notranslate"><span class="pre">system_one</span></code> because we are looking at two identical atoms. Again, we have to restrict the energy range for coupling. Then we proceed to set the distance between the two atoms and the interaction angle.</p>
<p>To speed up the calculation, we tell pairinteraction that this system will have some symmetries.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">setup_system_two</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
    <span class="n">system_two</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">SystemTwo</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span> <span class="n">system_one</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">restrictEnergy</span><span class="p">(</span><span class="n">state_two</span><span class="o">.</span><span class="n">getEnergy</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">state_two</span><span class="o">.</span><span class="n">getEnergy</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setDistance</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setConservedParityUnderPermutation</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">ODD</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">system_two</span>
</pre></div>
</div>
</div>
<p>Now, we use the definitions from above to compose our calculation. Since we are only interested in pair potential curves close to the investigated pair state, we further restrict the energy range after diagonalizing the two atom system.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">getSystems</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">system_one</span><span class="p">,</span> <span class="n">fieldshift</span><span class="p">):</span>
    <span class="c1"># Set up two atom system</span>
    <span class="n">system_two</span> <span class="o">=</span> <span class="n">setup_system_two</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)</span>

    <span class="c1"># Restrict the calculated eigenenergies</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">restrictEnergy</span><span class="p">(</span><span class="n">fieldshift</span> <span class="o">-</span> <span class="mf">0.015</span><span class="p">,</span> <span class="n">fieldshift</span> <span class="o">+</span> <span class="mf">0.015</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">buildHamiltonian</span><span class="p">()</span>  <span class="c1"># has to be called to apply the new restriction in energy</span>
    <span class="k">return</span> <span class="n">system_two</span>
</pre></div>
</div>
</div>
<p>Finally, we run the calculations for the given values of the electric field. The method <code class="docutils literal notranslate"><span class="pre">getConnections</span></code> tells which eigenenergies are adiabatically connected and make up pair potential curves. Using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, we plot the resulting pair potential curves which are colored accordingly to the overlap with the investigated pair state.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">efield</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">efields</span><span class="p">):</span>
    <span class="c1"># Set up one atom systems</span>
    <span class="n">system_one</span> <span class="o">=</span> <span class="n">setup_system_one</span><span class="p">(</span><span class="n">efield</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)</span>
    <span class="n">fieldshift</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">2</span>
        <span class="o">*</span> <span class="n">system_one</span><span class="o">.</span><span class="n">getHamiltonian</span><span class="p">()</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()[</span>
            <span class="n">system_one</span><span class="o">.</span><span class="n">getBasisvectorIndex</span><span class="p">(</span><span class="n">state_one</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># Get diagonalized two atom systems</span>
    <span class="n">systems_two</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">map</span><span class="p">(</span>
            <span class="n">partial</span><span class="p">(</span><span class="n">getSystems</span><span class="p">,</span> <span class="n">system_one</span><span class="o">=</span><span class="n">system_one</span><span class="p">,</span> <span class="n">fieldshift</span><span class="o">=</span><span class="n">fieldshift</span><span class="p">),</span>
            <span class="n">distances</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Plot pair potentials</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$E_z$ = $</span><span class="si">{</span><span class="n">efield</span> <span class="o">*</span> <span class="mf">1e3</span><span class="si">}</span><span class="s2">$ mV/cm&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Distance (µm)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">distances</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">systems_two</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">systems_two</span><span class="p">))):</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">systems_two</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">getConnections</span><span class="p">(</span><span class="n">systems_two</span><span class="p">[</span><span class="n">i2</span><span class="p">],</span> <span class="mf">0.001</span><span class="p">))</span>
        <span class="n">segment_distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">distances</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">distances</span><span class="p">[</span><span class="n">i2</span><span class="p">]]</span>
        <span class="n">segment_energies</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">systems_two</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">getHamiltonian</span><span class="p">()</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()[</span><span class="n">c1</span><span class="p">],</span>
                    <span class="n">systems_two</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span><span class="o">.</span><span class="n">getHamiltonian</span><span class="p">()</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()[</span><span class="n">c2</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="o">-</span> <span class="n">fieldshift</span>
        <span class="p">)</span> <span class="o">*</span> <span class="mf">1e3</span>  <span class="c1"># MHz</span>
        <span class="n">segment_overlap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">systems_two</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">getOverlap</span><span class="p">(</span><span class="n">state_two</span><span class="p">)[</span><span class="n">c1</span><span class="p">],</span>
                <span class="n">systems_two</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span><span class="o">.</span><span class="n">getOverlap</span><span class="p">(</span><span class="n">state_two</span><span class="p">)[</span><span class="n">c2</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">segment_color</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis_r</span><span class="p">(</span><span class="n">segment_overlap</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">cycler</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">segment_color</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">segment_distances</span><span class="p">,</span> <span class="n">segment_energies</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Energy (MHz)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_python_pair_potential_efield_sensitivity_17_0.png" src="../_images/examples_python_pair_potential_efield_sensitivity_17_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="vdw_near_surface.html" class="btn btn-neutral float-right" title="2.2.6. Dispersion Coefficients Near Surfaces" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="comparison_to_saffman_fig13.html" class="btn btn-neutral float-left" title="2.2.4. Blockade Interaction in a Magnetic Field" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017, Sebastian Weber, Henri Menke.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>